---
import { Icon } from 'astro-icon/components';
---

<div class="manager-dash bg-neutral-white h-full flex flex-col font-sans relative overflow-hidden text-neutral-text select-none pointer-events-none">
  
  <!-- 2. Header (Fixed Height) -->
  <div class="bg-white px-5 pt-8 pb-3 shadow-sm z-10 flex justify-between items-center border-b border-neutral-border shrink-0">
      <!-- Avatar -->
      <div class="w-8 h-8 rounded-full bg-brand-primary-soft overflow-hidden border border-neutral-border flex items-center justify-center text-brand-primary font-bold text-xs">
         M
      </div>

      <!-- Branding -->
      <div class="flex items-center gap-1.5">
          <span class="font-bold text-base tracking-tight text-brand-primary">VendoYo</span>
          <Icon name="circle-flags:ua" class="w-4 h-4 shadow-sm" />
      </div>

      <!-- Notifications -->
      <div class="w-8 h-8 rounded-full bg-white border border-neutral-border flex items-center justify-center relative text-neutral-muted">
          <Icon name="heroicons:bell" class="w-4 h-4" />
          <div class="absolute top-2 right-2 w-2 h-2 bg-danger rounded-full border border-white"></div>
      </div>
  </div>

  <!-- Content Container -->
  <div class="flex-1 flex flex-col px-5 py-3 overflow-hidden relative z-0 space-y-3">
      
      <!-- Bloque Superior: Saludo + KPIs -->
      <div class="space-y-3 shrink-0">
          <!-- 3. Saludo -->
          <div class="animate-enter opacity-0 translate-y-4">
              <h1 class="text-lg font-bold text-neutral-text leading-tight">Bienvenido, Manager 游녦</h1>
              <p class="text-neutral-muted text-[10px]">Resumen de tu franquicia hoy.</p>
          </div>

          <!-- 4. KPIs -->
          <div class="grid grid-cols-2 gap-3 animate-enter opacity-0 translate-y-4" style="animation-delay: 100ms;">
              <div class="bg-white p-3 rounded-xl shadow-sm border border-neutral-border relative">
                  <div class="w-6 h-6 bg-brand-primary-soft rounded-md flex items-center justify-center text-brand-primary mb-2">
                      <Icon name="heroicons:home-modern" class="w-3.5 h-3.5" />
                  </div>
                  <div class="text-xl font-bold text-neutral-text leading-none">10</div>
                  <div class="text-[9px] text-neutral-muted font-bold uppercase mt-1">Activas</div>
                  <div class="absolute top-3 right-3 w-1.5 h-1.5 bg-brand-primary rounded-full animate-pulse"></div>
              </div>

              <div class="bg-white p-3 rounded-xl shadow-sm border border-neutral-border relative">
                  <div class="w-6 h-6 bg-brand-primary-soft rounded-md flex items-center justify-center text-brand-primary-dark mb-2">
                      <Icon name="heroicons:users" class="w-3.5 h-3.5" />
                  </div>
                  <div class="text-xl font-bold text-neutral-text leading-none">6</div>
                  <div class="text-[9px] text-neutral-muted font-bold uppercase mt-1">Total</div>
              </div>
          </div>
      </div>

      <!-- Bloque Central: CTA -->
      <div class="animate-enter opacity-0 translate-y-4 shrink-0" style="animation-delay: 200ms;">
          <!-- 5. CTA Principal -->
          <div class="w-full bg-brand-primary text-white p-3 rounded-xl shadow-lg shadow-brand-primary/20 flex items-center justify-between">
              <div class="flex items-center gap-3">
                  <div class="w-8 h-8 bg-white/20 rounded-lg flex items-center justify-center">
                      <Icon name="heroicons:plus" class="w-4 h-4 text-white" />
                  </div>
                  <div class="text-left">
                      <div class="font-bold text-sm">Gestionar Propiedades</div>
                      <div class="text-[10px] text-brand-primary-soft opacity-90">A침adir o editar</div>
                  </div>
              </div>
              <Icon name="heroicons:chevron-right" class="w-4 h-4 opacity-80" />
          </div>
      </div>

      <!-- Bloque Inferior: Accesos + Lista -->
      <div class="space-y-3 flex-1 flex flex-col justify-start min-h-0">
          <!-- 6. Accesos R치pidos -->
          <div class="animate-enter opacity-0 translate-y-4 shrink-0" style="animation-delay: 300ms;">
              <h2 class="font-bold text-neutral-text text-[10px] mb-2 uppercase tracking-wide">Accesos R치pidos</h2>
              <div class="grid grid-cols-2 gap-2">
                  <div class="bg-white p-2.5 rounded-lg border border-neutral-border flex items-center gap-2 shadow-sm">
                      <div class="w-6 h-6 bg-neutral-border/30 rounded-full flex items-center justify-center text-neutral-muted">
                          <Icon name="heroicons:building-office-2" class="w-3.5 h-3.5" />
                      </div>
                      <div>
                          <div class="font-bold text-xs text-neutral-text">Cartera</div>
                          <div class="text-[9px] text-neutral-muted">Gestionar</div>
                      </div>
                  </div>
                  <div class="bg-white p-2.5 rounded-lg border border-neutral-border flex items-center gap-2 shadow-sm">
                      <div class="w-6 h-6 bg-neutral-border/30 rounded-full flex items-center justify-center text-neutral-muted">
                          <Icon name="heroicons:user-group" class="w-3.5 h-3.5" />
                      </div>
                      <div>
                          <div class="font-bold text-xs text-neutral-text">Propietarios</div>
                          <div class="text-[9px] text-neutral-muted">Clientes</div>
                      </div>
                  </div>
              </div>
          </div>

          <!-- 7. Secci칩n Propiedades (Flexible) -->
          <div class="animate-enter opacity-0 translate-y-4 flex-1 min-h-0 flex flex-col" style="animation-delay: 400ms;">
              <div class="flex justify-between items-center mb-2 shrink-0">
                  <h2 class="font-bold text-neutral-text text-[10px] uppercase tracking-wide">Recientes</h2>
                  <div class="text-[9px] text-brand-primary font-bold bg-brand-primary-soft px-1.5 py-0.5 rounded">Filtrar</div>
              </div>
              
              <!-- Lista con 2 items -->
              <div class="space-y-2 overflow-hidden">
                  <!-- Item 1 -->
                  <div class="bg-white p-2.5 rounded-xl border border-neutral-border shadow-sm flex gap-3 items-center">
                      <div class="w-10 h-10 bg-neutral-border rounded-lg bg-cover bg-center shrink-0" style="background-image: url('https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?auto=format&fit=crop&w=100&q=80')"></div>
                      <div class="flex-1 min-w-0">
                          <div class="flex justify-between items-center">
                              <h3 class="font-bold text-neutral-text text-xs truncate pr-2">츼tico en Centro</h3>
                              <span class="bg-brand-primary-soft text-brand-primary-dark text-[9px] font-bold px-1.5 py-0.5 rounded">Activo</span>
                          </div>
                          <p class="text-[10px] text-neutral-muted mt-0.5 truncate">C/ Mayor 12, Madrid</p>
                          <div class="flex items-center gap-1 mt-1">
                              <div class="w-3 h-3 rounded-full bg-brand-primary text-white flex items-center justify-center text-[6px] font-bold">JP</div>
                              <span class="text-[9px] text-neutral-muted">Juan P칠rez</span>
                          </div>
                      </div>
                  </div>

                  <!-- Item 2 -->
                  <div class="bg-white p-2.5 rounded-xl border border-neutral-border shadow-sm flex gap-3 items-center">
                      <div class="w-10 h-10 bg-neutral-border rounded-lg bg-cover bg-center shrink-0" style="background-image: url('https://images.unsplash.com/photo-1512917774080-9991f1c4c750?auto=format&fit=crop&w=100&q=80')"></div>
                      <div class="flex-1 min-w-0">
                          <div class="flex justify-between items-center">
                              <h3 class="font-bold text-neutral-text text-xs truncate pr-2">Loft Moderno</h3>
                              <span class="bg-orange-50 text-orange-700 text-[9px] font-bold px-1.5 py-0.5 rounded border border-orange-100">Revisi칩n</span>
                          </div>
                          <p class="text-[10px] text-neutral-muted mt-0.5 truncate">Av. Libertad 45, Valencia</p>
                          <div class="flex items-center gap-1 mt-1">
                              <div class="w-3 h-3 rounded-full bg-blue-100 text-blue-700 flex items-center justify-center text-[6px] font-bold">MG</div>
                              <span class="text-[9px] text-neutral-muted">Marta Garc칤a</span>
                          </div>
                      </div>
                  </div>
              </div>
          </div>
      </div>
  </div>

  <!-- 8. Bottom Navigation (Compact) -->
  <div class="bg-white border-t border-neutral-border px-6 py-2 shrink-0 flex justify-between items-center pb-4 z-20">
      <div class="flex flex-col items-center gap-0.5 text-brand-primary">
          <Icon name="heroicons:home" class="w-5 h-5" />
          <span class="text-[8px] font-bold">Inicio</span>
      </div>
      <div class="flex flex-col items-center gap-0.5 text-neutral-muted opacity-60">
          <Icon name="heroicons:building-office-2" class="w-5 h-5" />
          <span class="text-[8px] font-medium">Props</span>
      </div>
      <div class="flex flex-col items-center gap-0.5 text-neutral-muted opacity-60">
          <Icon name="heroicons:users" class="w-5 h-5" />
          <span class="text-[8px] font-medium">Clientes</span>
      </div>
      <div class="flex flex-col items-center gap-0.5 text-neutral-muted opacity-60">
          <Icon name="heroicons:user-circle" class="w-5 h-5" />
          <span class="text-[8px] font-medium">Perfil</span>
      </div>
  </div>

</div>

<script>
  import gsap from 'gsap';

  declare global {
    interface Window {
      animateManagerDashboard: (container?: Document | Element) => gsap.core.Timeline;
    }
  }

  window.animateManagerDashboard = (container = document) => {
      const tl = gsap.timeline();
      
      const elements = container.querySelectorAll('.animate-enter');
      
      gsap.set(elements, { opacity: 0, y: 20 });

      tl.to(elements, {
          y: 0,
          opacity: 1,
          duration: 0.6,
          stagger: 0.1,
          ease: "power2.out"
      });

      return tl;
  }
</script>