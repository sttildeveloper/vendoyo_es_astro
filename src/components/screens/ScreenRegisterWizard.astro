---
/**
 * ScreenRegisterWizard.astro
 * Wizard de registro completo con 3 pasos:
 * Step 0: Selección de tipo de usuario
 * Step 1: Datos de acceso (razón social, email, contraseña)
 * Step 2: Ubicación (ciudad, dirección)
 * Basado en registro.png del diseño
 */
import { Icon } from 'astro-icon/components';
---

<div class="screen-container bg-organic">
  <!-- Full-height White Card (no scroll) -->
  <div class="flex-1 flex flex-col px-3 pt-6 pb-4 relative z-10">
    <div class="flex-1 flex flex-col w-full bg-white rounded-2xl shadow-2xl p-4">
      
      <!-- Logo -->
      <div class="text-center mb-2">
        <h1 class="text-lg font-extrabold text-brand-primary tracking-tight flex items-center justify-center gap-2">
          VENDOYO
          <Icon name="circle-flags:ua" class="w-3.5 h-3.5 shadow-sm" />
        </h1>
      </div>

      <!-- Stepper Header (Hidden on Step 0, visible from Step 1) -->
      <div id="wizard-stepper" class="opacity-0 w-full transition-opacity duration-300 mb-2">
        <div class="flex items-center justify-center gap-2">
          <div class="h-1 rounded-full transition-all duration-500 wizard-dot-1 w-6 bg-brand-primary"></div>
          <div class="h-1 rounded-full transition-all duration-500 wizard-dot-2 w-1.5 bg-neutral-border"></div>
          <div class="h-1 rounded-full transition-all duration-500 wizard-dot-3 w-1.5 bg-neutral-border"></div>
        </div>
      </div>

      <!-- Wizard Steps Container (flex-1 to fill available space) -->
      <div class="relative flex-1 w-full">
        
        <!-- STEP 0: Tipo de Usuario -->
        <div id="wiz-step-0" class="absolute inset-0 flex flex-col justify-center w-full h-full transition-all duration-500">
          <div class="mb-3 text-center">
            <h2 class="text-sm font-bold text-neutral-text">Crear cuenta</h2>
            <p class="text-neutral-muted text-[10px] mt-0.5">¿Qué tipo de usuario eres?</p>
          </div>
          <div class="space-y-2 w-full">
            <!-- Franchisor Card -->
            <div id="type-franchisor" class="p-3 rounded-xl border-2 border-neutral-border bg-white transition-all duration-300 w-full shadow-sm cursor-pointer hover:border-brand-primary">
              <div class="flex items-center gap-2">
                <div class="w-10 h-10 rounded-lg bg-brand-primary flex items-center justify-center text-white flex-shrink-0 shadow-md">
                  <Icon name="heroicons:building-storefront" class="w-5 h-5" />
                </div>
                <div class="flex-1">
                  <h3 class="font-bold text-xs text-neutral-text">Soy Franquiciador</h3>
                  <p class="text-[9px] text-neutral-muted">Gestiona tu red de franquicias</p>
                </div>
                <Icon name="heroicons:chevron-right" class="w-3.5 h-3.5 text-neutral-border" />
              </div>
            </div>
            <!-- Owner Card -->
            <div id="type-owner" class="p-3 rounded-xl border-2 border-neutral-border bg-white transition-all duration-300 w-full shadow-sm cursor-pointer hover:border-brand-primary">
              <div class="flex items-center gap-2">
                <div class="w-10 h-10 rounded-lg bg-brand-soft flex items-center justify-center text-brand-primary flex-shrink-0">
                  <Icon name="heroicons:home-modern" class="w-5 h-5" />
                </div>
                <div class="flex-1">
                  <h3 class="font-bold text-xs text-neutral-text">Soy Propietario</h3>
                  <p class="text-[9px] text-neutral-muted">Tarifa plana de gestión</p>
                </div>
                <Icon name="heroicons:chevron-right" class="w-3.5 h-3.5 text-neutral-border" />
              </div>
            </div>
          </div>
        </div>

        <!-- STEP 1: Datos Básicos (hidden initially, GSAP controls visibility) -->
        <div id="wiz-step-1" class="absolute inset-0 flex flex-col justify-center items-center w-full h-full" style="opacity: 0; display: none;">
          <div class="mb-3 text-center w-full">
            <h2 class="text-sm font-bold text-neutral-text">Datos de acceso</h2>
            <p class="text-[10px] text-neutral-muted">Configura tu perfil</p>
          </div>
          <div class="space-y-2 w-full mb-3">
            <div class="space-y-0.5">
              <label class="text-[9px] font-bold text-neutral-muted uppercase ml-1">Razón Social</label>
              <div id="wiz-field-company" class="input-mock w-full shadow-sm text-xs"></div>
            </div>
            <div class="space-y-0.5">
              <label class="text-[9px] font-bold text-neutral-muted uppercase ml-1">Email</label>
              <div id="wiz-field-email" class="input-mock w-full shadow-sm text-xs"></div>
            </div>
            <div class="space-y-0.5">
              <label class="text-[9px] font-bold text-neutral-muted uppercase ml-1">Contraseña</label>
              <div id="wiz-field-pass" class="input-mock w-full shadow-sm text-xs"></div>
            </div>
          </div>
          <div class="w-full">
            <div id="wiz-btn-step1" class="btn-brand w-full shadow-md py-2.5 rounded-lg text-center text-xs">Continuar</div>
          </div>
        </div>

        <!-- STEP 2: Ubicación (hidden initially, GSAP controls visibility) -->
        <div id="wiz-step-2" class="absolute inset-0 flex flex-col justify-center items-center w-full h-full" style="opacity: 0; display: none;">
          <div class="mb-3 text-center w-full">
            <h2 class="text-sm font-bold text-neutral-text">Ubicación</h2>
            <p class="text-[10px] text-neutral-muted">¿Dónde operará tu negocio?</p>
          </div>
          <div class="space-y-2 w-full mb-3">
            <div class="space-y-0.5">
              <label class="text-[9px] font-bold text-neutral-muted uppercase ml-1">Ciudad</label>
              <div id="wiz-field-city" class="input-mock w-full shadow-sm text-xs"></div>
            </div>
            <div class="space-y-0.5">
              <label class="text-[9px] font-bold text-neutral-muted uppercase ml-1">Dirección</label>
              <div id="wiz-field-addr" class="input-mock w-full shadow-sm text-xs"></div>
            </div>
          </div>
          <div class="w-full">
            <div id="wiz-btn-finish" class="btn-brand flex items-center justify-center gap-2 w-full shadow-md py-2.5 rounded-lg text-xs">
              Finalizar Registro
              <Icon id="wiz-spinner" name="heroicons:arrow-path" class="w-3.5 h-3.5 animate-spin hidden" />
            </div>
          </div>
        </div>

      </div>

      <!-- Footer -->
      <div class="text-center pt-2 mt-auto">
        <p class="text-[10px] text-neutral-muted">
          ¿Ya tienes cuenta? 
          <span id="btn-to-login" class="text-brand-primary font-bold cursor-pointer">Inicia sesión</span>
        </p>
      </div>
    </div>
  </div>

  <!-- Success Alert (Hidden by default) - centered with max-width -->
  <div 
    id="reg-alert" 
    class="absolute top-6 left-1/2 -translate-x-1/2 w-[85%] max-w-[260px] bg-neutral-text text-white p-3 rounded-2xl shadow-2xl flex items-center gap-3 z-50 transform -translate-y-32 opacity-0"
  >
    <div class="w-9 h-9 bg-brand-primary rounded-full flex items-center justify-center flex-shrink-0">
      <Icon name="heroicons:check" class="w-5 h-5 text-white" />
    </div>
    <div>
      <h3 class="text-sm font-bold">¡Cuenta Creada!</h3>
      <p class="text-[10px] text-brand-soft opacity-80">Verifica tu email ahora.</p>
    </div>
  </div>
</div>
