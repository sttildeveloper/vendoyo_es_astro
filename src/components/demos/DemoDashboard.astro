---
/**
 * DemoDashboard.astro
 * Demo animado del dashboard con contadores, gráfica y exportación
 * Basado en home/index y dashboard/index del proyecto React Native
 */
import { Icon } from 'astro-icon/components';
import MobileFrame from '../ui/MobileFrame.astro';

interface Props {
  height?: string;
  class?: string;
}

const { height = "530px", class: className = "" } = Astro.props;
---

<MobileFrame height={height} class={className}>
  <div class="demo-dashboard h-full flex flex-col bg-slate-50" id="demo-dashboard-container">
    
    <!-- Header -->
    <div class="bg-white px-3 py-2 border-b border-neutral-border flex items-center justify-between pt-6">
      <div class="flex items-center gap-2">
        <Icon name="heroicons:chart-bar" class="w-4 h-4 text-brand-primary" />
        <span class="text-sm font-bold text-neutral-text">Dashboard</span>
      </div>
      <div class="flex items-center gap-1">
        <span class="text-[9px] text-neutral-muted">Hoy</span>
        <Icon name="heroicons:chevron-down" class="w-3 h-3 text-neutral-muted" />
      </div>
    </div>

    <!-- Content -->
    <div class="flex-1 p-3 space-y-3 overflow-hidden">
      
      <!-- Stats Row -->
      <div class="grid grid-cols-2 gap-2">
        <div class="bg-white rounded-xl p-3 border border-neutral-border">
          <div class="flex items-center gap-1 mb-1">
            <div class="w-6 h-6 bg-brand-primary-soft rounded-lg flex items-center justify-center">
              <Icon name="heroicons:building-office-2" class="w-3 h-3 text-brand-primary" />
            </div>
          </div>
          <p class="text-[9px] text-neutral-muted uppercase">Propiedades</p>
          <div class="flex items-baseline gap-1">
            <span id="dash-counter-1" class="text-xl font-bold text-neutral-text">0</span>
            <span class="text-[9px] text-accent-success flex items-center">
              <Icon name="heroicons:arrow-trending-up" class="w-2 h-2" />
              +12%
            </span>
          </div>
        </div>
        <div class="bg-white rounded-xl p-3 border border-neutral-border">
          <div class="flex items-center gap-1 mb-1">
            <div class="w-6 h-6 bg-blue-50 rounded-lg flex items-center justify-center">
              <Icon name="heroicons:clipboard-document-check" class="w-3 h-3 text-blue-600" />
            </div>
          </div>
          <p class="text-[9px] text-neutral-muted uppercase">Trámites</p>
          <div class="flex items-baseline gap-1">
            <span id="dash-counter-2" class="text-xl font-bold text-neutral-text">0</span>
            <span class="text-[9px] text-accent-success flex items-center">
              <Icon name="heroicons:arrow-trending-up" class="w-2 h-2" />
              +8%
            </span>
          </div>
        </div>
      </div>

      <!-- Mini Chart -->
      <div class="bg-white rounded-xl p-3 border border-neutral-border">
        <div class="flex items-center justify-between mb-2">
          <p class="text-[10px] font-bold text-neutral-text">Actividad semanal</p>
          <div class="flex gap-1">
            <span class="w-2 h-2 rounded-full bg-brand-primary"></span>
            <span class="text-[8px] text-neutral-muted">Propiedades</span>
            <span class="w-2 h-2 rounded-full bg-blue-500 ml-1"></span>
            <span class="text-[8px] text-neutral-muted">Trámites</span>
          </div>
        </div>
        
        <!-- SVG Chart -->
        <div class="h-16 relative">
          <svg viewBox="0 0 200 60" class="w-full h-full">
            <!-- Grid lines -->
            <line x1="0" y1="15" x2="200" y2="15" stroke="#E5E7EB" stroke-width="0.5"/>
            <line x1="0" y1="30" x2="200" y2="30" stroke="#E5E7EB" stroke-width="0.5"/>
            <line x1="0" y1="45" x2="200" y2="45" stroke="#E5E7EB" stroke-width="0.5"/>
            
            <!-- Area fill -->
            <path id="dash-area" d="M0,55 L0,55 L40,55 L80,55 L120,55 L160,55 L200,55 L200,55 L0,55" 
                  fill="url(#gradient1)" opacity="0.3"/>
            
            <!-- Line 1 (Propiedades) -->
            <path id="dash-line-1" 
                  d="M0,50 L40,50 L80,50 L120,50 L160,50 L200,50" 
                  fill="none" 
                  stroke="#0B8F7A" 
                  stroke-width="2"
                  stroke-linecap="round"/>
            
            <!-- Line 2 (Trámites) -->
            <path id="dash-line-2" 
                  d="M0,50 L40,50 L80,50 L120,50 L160,50 L200,50" 
                  fill="none" 
                  stroke="#3B82F6" 
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-dasharray="4,2"/>
            
            <defs>
              <linearGradient id="gradient1" x1="0%" y1="0%" x2="0%" y2="100%">
                <stop offset="0%" style="stop-color:#0B8F7A;stop-opacity:0.4"/>
                <stop offset="100%" style="stop-color:#0B8F7A;stop-opacity:0"/>
              </linearGradient>
            </defs>
          </svg>
          
          <!-- X Labels -->
          <div class="absolute bottom-0 left-0 right-0 flex justify-between text-[7px] text-neutral-muted">
            <span>Lun</span><span>Mar</span><span>Mié</span><span>Jue</span><span>Vie</span>
          </div>
        </div>
      </div>

      <!-- Export Button -->
      <div class="flex gap-2">
        <button id="dash-export-btn" class="flex-1 bg-white border border-neutral-border text-neutral-text text-[10px] font-bold py-2 rounded-lg flex items-center justify-center gap-1">
          <Icon name="heroicons:arrow-down-tray" class="w-3 h-3" />
          Exportar CSV
        </button>
        <button class="flex-1 bg-brand-primary text-white text-[10px] font-bold py-2 rounded-lg flex items-center justify-center gap-1">
          <Icon name="heroicons:document-chart-bar" class="w-3 h-3" />
          Ver reportes
        </button>
      </div>

      <!-- Export Success Toast -->
      <div id="dash-export-toast" class="absolute bottom-16 left-1/2 -translate-x-1/2 bg-neutral-text text-white px-3 py-2 rounded-full text-[10px] font-bold flex items-center gap-2 opacity-0 shadow-xl z-50">
        <Icon name="heroicons:check-circle" class="w-4 h-4 text-accent-success" />
        reporte_2024.csv descargado
      </div>

    </div>
  </div>
</MobileFrame>
