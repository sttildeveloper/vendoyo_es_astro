---
/**
 * DemoWorkflow.astro
 * Demo animado del wizard de trámites con pasos, cliente y adjuntos
 * Basado en tramites/nuevo del proyecto React Native
 */
import { Icon } from 'astro-icon/components';
import MobileFrame from '../ui/MobileFrame.astro';
---

<MobileFrame height="530px">
  <div class="demo-workflow h-full flex flex-col bg-white" id="demo-workflow-container">
    
    <!-- Header -->
    <div class="bg-white px-3 py-2 border-b border-neutral-border flex items-center gap-2 pt-6">
      <Icon name="heroicons:arrow-left" class="w-4 h-4 text-neutral-muted" />
      <span id="wf-header" class="text-sm font-bold text-neutral-text">Nuevo Trámite</span>
      <div class="ml-auto flex gap-1">
        <div id="wf-dot-1" class="w-2 h-2 rounded-full bg-brand-primary"></div>
        <div id="wf-dot-2" class="w-2 h-2 rounded-full bg-neutral-border"></div>
        <div id="wf-dot-3" class="w-2 h-2 rounded-full bg-neutral-border"></div>
      </div>
    </div>

    <!-- Content Area -->
    <div class="flex-1 relative overflow-hidden">
      
      <!-- Step 1: Info Básica -->
      <div id="wf-step-1" class="absolute inset-0 p-3 flex flex-col">
        <p class="text-[10px] text-neutral-muted mb-2">Paso 1 de 3</p>
        <h3 class="text-sm font-bold text-neutral-text mb-3">Información básica</h3>
        
        <div class="space-y-2 flex-1">
          <div>
            <label class="text-[9px] text-neutral-muted uppercase">Título del trámite</label>
            <div class="bg-white border border-neutral-border rounded-lg px-2 py-2 text-xs flex items-center">
              <span id="wf-title-text" class="text-neutral-text"></span>
              <span id="wf-cursor-1" class="w-0.5 h-3 bg-brand-primary ml-0.5 animate-pulse"></span>
            </div>
          </div>
          <div>
            <label class="text-[9px] text-neutral-muted uppercase">Prioridad</label>
            <div class="flex gap-1">
              <span id="wf-prio-alta" class="px-2 py-1 text-[10px] rounded-full bg-neutral-border text-neutral-muted">Alta</span>
              <span id="wf-prio-media" class="px-2 py-1 text-[10px] rounded-full bg-brand-primary text-white">Media</span>
              <span class="px-2 py-1 text-[10px] rounded-full bg-neutral-border text-neutral-muted">Baja</span>
            </div>
          </div>
          <div>
            <label class="text-[9px] text-neutral-muted uppercase">Descripción</label>
            <div class="bg-white border border-neutral-border rounded-lg px-2 py-2 text-[10px] text-neutral-muted h-12">
              <span id="wf-desc-text"></span>
            </div>
          </div>
        </div>
        
        <button id="wf-btn-next-1" class="mt-2 w-full bg-brand-primary text-white text-xs font-bold py-2 rounded-lg flex items-center justify-center gap-1">
          Siguiente
          <Icon name="heroicons:arrow-right" class="w-3 h-3" />
        </button>
      </div>

      <!-- Step 2: Cliente -->
      <div id="wf-step-2" class="absolute inset-0 p-3 flex flex-col" style="opacity: 0; transform: translateX(100%);">
        <p class="text-[10px] text-neutral-muted mb-2">Paso 2 de 3</p>
        <h3 class="text-sm font-bold text-neutral-text mb-3">Seleccionar cliente</h3>
        
        <!-- Search -->
        <div class="bg-white border border-neutral-border rounded-lg px-2 py-2 flex items-center gap-2 mb-3">
          <Icon name="heroicons:magnifying-glass" class="w-3 h-3 text-neutral-muted" />
          <span id="wf-search-text" class="text-xs text-neutral-muted"></span>
        </div>
        
        <!-- Client List -->
        <div class="space-y-2 flex-1">
          <div id="wf-client-1" class="bg-white border border-neutral-border rounded-lg p-2 flex items-center gap-2 opacity-50">
            <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 text-xs font-bold">JP</div>
            <div class="flex-1">
              <p class="text-xs font-bold text-neutral-text">Juan Pérez</p>
              <p class="text-[9px] text-neutral-muted">juan@email.com</p>
            </div>
          </div>
          <div id="wf-client-2" class="bg-white border-2 border-brand-primary rounded-lg p-2 flex items-center gap-2">
            <div class="w-8 h-8 bg-brand-primary-soft rounded-full flex items-center justify-center text-brand-primary text-xs font-bold">MG</div>
            <div class="flex-1">
              <p class="text-xs font-bold text-neutral-text">María García</p>
              <p class="text-[9px] text-neutral-muted">maria@empresa.com</p>
            </div>
            <Icon name="heroicons:check-circle-solid" class="w-5 h-5 text-brand-primary" />
          </div>
        </div>
        
        <button id="wf-btn-next-2" class="mt-2 w-full bg-brand-primary text-white text-xs font-bold py-2 rounded-lg">
          Siguiente
        </button>
      </div>

      <!-- Step 3: Adjuntos -->
      <div id="wf-step-3" class="absolute inset-0 p-3 flex flex-col" style="opacity: 0; transform: translateX(100%);">
        <p class="text-[10px] text-neutral-muted mb-2">Paso 3 de 3</p>
        <h3 class="text-sm font-bold text-neutral-text mb-3">Adjuntar documentos</h3>
        
        <!-- Upload Area -->
        <div id="wf-upload-area" class="border-2 border-dashed border-neutral-border rounded-xl p-4 text-center mb-3 bg-white">
          <Icon name="heroicons:cloud-arrow-up" class="w-8 h-8 text-neutral-muted mx-auto mb-1" />
          <p class="text-[10px] text-neutral-muted">Toca para subir archivo</p>
        </div>
        
        <!-- Uploaded File -->
        <div id="wf-uploaded-file" class="bg-white border border-neutral-border rounded-lg p-2 flex items-center gap-2 opacity-0">
          <div class="w-10 h-10 bg-brand-primary-soft rounded-lg flex items-center justify-center">
            <Icon name="heroicons:document" class="w-5 h-5 text-brand-primary" />
          </div>
          <div class="flex-1">
            <p class="text-xs font-bold text-neutral-text">contrato_2024.pdf</p>
            <p class="text-[9px] text-neutral-muted">245 KB</p>
          </div>
          <Icon name="heroicons:check-circle-solid" class="w-5 h-5 text-accent-success" />
        </div>
        
        <div class="flex-1"></div>
        
        <button id="wf-btn-save" class="w-full bg-brand-primary text-white text-xs font-bold py-2.5 rounded-lg flex items-center justify-center gap-1">
          <Icon name="heroicons:check" class="w-4 h-4" />
          Crear Trámite
        </button>
      </div>

      <!-- Success State -->
      <div id="wf-success" class="absolute inset-0 bg-white flex flex-col items-center justify-center p-4 text-center" style="opacity: 0;">
        <div class="w-14 h-14 bg-accent-success/20 rounded-full flex items-center justify-center mb-3">
          <Icon name="heroicons:check" class="w-8 h-8 text-accent-success" />
        </div>
        <h3 class="text-sm font-bold text-neutral-text mb-1">¡Trámite creado!</h3>
        <p class="text-[10px] text-neutral-muted">Se ha asignado a María García</p>
      </div>

    </div>
  </div>
</MobileFrame>
